<?phpclass Product extends CI_Model {	private $productId;	private $productTitle;	private $productSlug;	private $productPrice;	private $productAvailability;	public function __construct($dataRow = FALSE)	{		$this->load->database();		$this->productId = 0;		$this->productTitle = '';		$this->productSlug = '';		$this->productPrice = 0;		$this->productAvailability = 0;		if (!empty($dataRow))		{			if(isset($dataRow['product_id'])) $this->productId = $dataRow['product_id'];			if(isset($dataRow['product_title'])) $this->productTitle = $dataRow['product_title'];			if(isset($dataRow['product_slug'])) $this->productSlug = $dataRow['product_slug'];			if(isset($dataRow['product_price'])) $this->productPrice = $dataRow['product_price'];			if(isset($dataRow['product_availability'])) $this->productAvailability = $dataRow['product_availability'];		}	}		public function isEmpty()	{		if ($this->getId() == 0) return true;		else return false;	}		public function getId()	{		return $this->productId;	}		//should I wanna leave only double quotes in Title:	//htmlspecialchars($string, ENT_QUOTES & ~ENT_COMPAT, $encoding); 	public function getTitle()	{		return htmlspecialchars($this->productTitle, ENT_QUOTES, 'UTF-8');	}		public function getSlug()	{		return htmlspecialchars($this->productSlug, ENT_QUOTES, 'UTF-8');	}		public function getPrice()	{		return $this->productPrice;	}		public function getAvailability()	{		return $this->productAvailability;	}		public static function getProducts($productId = FALSE, $productSlug = FALSE)	{		//get an instance of CodeIgniter to access the database		$CI =& get_instance();				if ($productId === FALSE && $productSlug === FALSE)		{			$CI->db->order_by('product_price', 'desc');			$query = $CI->db->get('products');			$dataRows = $query->result_array();			$products  = array();			foreach($dataRows as $row)			{				$products[] = new Product($row);			}			return $products;		}				if ($productId === FALSE)		{			$query = $CI->db->get_where('products', array('product_slug' => $productSlug));			$row = $query->row_array();			return new Product($row);				}				if ($productSlug === FALSE)		{			$query = $CI->db->get_where('products', array('product_id' => $productId));			$row = $query->row_array();			return new Product($row);		}				$query = $CI->db->get_where('products', array('product_id' => $productId, 'product_slug' => $productSlug));			$row = $query->row_array();			return new Product($row);	}		public static function createProduct($data)	{		$CI =& get_instance();		return $CI->db->insert('products', $data);	}	public function updateProduct($data = false)	{		if (empty($data))		{			$data = array(				'product_title' => $this->getTitle(),				'product_slug' => $this->getSlug(),				'product_price' => $this->getPrice(),				'product_availability' => $this->getAvailability()			);		}		return $this->db->update('products', $data, array('product_id' => $this->getId()));	}	public static function selectProductForUpdate($id)	{		//get an instance of CodeIgniter to access the database		$CI =& get_instance();		if($id > 0) //TODO also, filter the id.		{			$sql = "SELECT * FROM products WHERE product_id = ? FOR UPDATE";			$query = $CI->db->query($sql, array($id)); 			$row = $query->row_array();			return new Product($row);		}		return false;	}	public function deleteProduct()	{		return $this->db->delete('products', array('product_id' => $this->getId()));	}}